/* stg.vwKlsInput - this view accomplishes the following: 1) recognize distinct Cases and assign unique IDs, 2) shift columns on some samples (MHR) to align with other samples  */

CREATE VIEW [stg].[vwKlsInput] 
AS
	WITH DateCte AS (SELECT DISTINCT CAST(Prop_0 AS DATE) AS SampleDate, ROW_NUMBER() OVER (ORDER BY CAST(Prop_0 AS DATE)) AS Rnk FROM stg.tKlsInput GROUP BY CAST(Prop_0 AS DATE) )
       , DateMapping AS (
			SELECT dc1.SampleDate, CASE WHEN dc2.Rnk  < dc1.Rnk THEN dc2.Rnk ELSE dc1.Rnk END AS CaseID FROM DateCte dc1 LEFT JOIN DateCte dc2 ON dc1.SampleDate = DATEADD(DAY, 1, dc2.SampleDate) 
		 )

	SELECT dm.CaseID
		  ,[Prop_0]
		  ,[Prop_1]
		  ,CASE WHEN Prop_1 = 'MHR' THEN NULL ELSE Prop_2 END AS [Prop_2]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_2]  ELSE [Prop_3]    END AS [Prop_3]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_3]   ELSE [Prop_4]	  END AS [Prop_4]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_4]	 ELSE [Prop_5]	  END AS [Prop_5]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_5]	 ELSE [Prop_6]	  END AS [Prop_6]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_6]	 ELSE [Prop_7]	  END AS [Prop_7]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_7]	 ELSE [Prop_8]	  END AS [Prop_8]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_8]	 ELSE [Prop_9]	  END AS [Prop_9]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_9]	 ELSE [Prop_10]	  END AS [Prop_10]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_10]	 ELSE [Prop_11]	  END AS [Prop_11]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_11]	 ELSE [Prop_12]	  END AS [Prop_12]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_12]	 ELSE [Prop_13]	  END AS [Prop_13]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_13]	 ELSE [Prop_14]	  END AS [Prop_14]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_14]	 ELSE [Prop_15]	  END AS [Prop_15]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_15]	 ELSE [Prop_16]	  END AS [Prop_16]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_16]	 ELSE [Prop_17]	  END AS [Prop_17]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_17]	 ELSE [Prop_18]	  END AS [Prop_18]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_18]	 ELSE [Prop_19]	  END AS [Prop_19]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_19]	 ELSE [Prop_20]	  END AS [Prop_20]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_20]	 ELSE [Prop_21]	  END AS [Prop_21]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_21]	 ELSE [Prop_22]	  END AS [Prop_22]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_22]	 ELSE [Prop_23]	  END AS [Prop_23]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_23]	 ELSE [Prop_24]	  END AS [Prop_24]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_24]	 ELSE [Prop_25]	  END AS [Prop_25]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_25]	 ELSE [Prop_26]	  END AS [Prop_26]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_26]	 ELSE [Prop_27]	  END AS [Prop_27]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_27]	 ELSE [Prop_28]	  END AS [Prop_28]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_28]	 ELSE [Prop_29]	  END AS [Prop_29]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_29]	 ELSE [Prop_30]	  END AS [Prop_30]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_30]	 ELSE [Prop_31]	  END AS [Prop_31]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_31]	 ELSE [Prop_32]	  END AS [Prop_32]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_32]	 ELSE [Prop_33]	  END AS [Prop_33]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_33]	 ELSE [Prop_34]	  END AS [Prop_34]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_34]	 ELSE [Prop_35]	  END AS [Prop_35]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_35]	 ELSE [Prop_36]	  END AS [Prop_36]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_36]	 ELSE [Prop_37]	  END AS [Prop_37]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_37]	 ELSE [Prop_38]	  END AS [Prop_38]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_38]	 ELSE [Prop_39]	  END AS [Prop_39]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_39]	 ELSE [Prop_40]	  END AS [Prop_40]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_40]	 ELSE [Prop_41]	  END AS [Prop_41]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_41]	 ELSE [Prop_42]	  END AS [Prop_42]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_42]	 ELSE [Prop_43]	  END AS [Prop_43]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_43]	 ELSE [Prop_44]	  END AS [Prop_44]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_44]	 ELSE [Prop_45]	  END AS [Prop_45]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_45]	 ELSE [Prop_46]	  END AS [Prop_46]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_46]	 ELSE [Prop_47]	  END AS [Prop_47]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_47]	 ELSE [Prop_48]	  END AS [Prop_48]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_48]	 ELSE [Prop_49]	  END AS [Prop_49]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_49]	 ELSE [Prop_50]	  END AS [Prop_50]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_50]	 ELSE [Prop_51]	  END AS [Prop_51]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_51]	 ELSE [Prop_52]	  END AS [Prop_52]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_52]	 ELSE [Prop_53]	  END AS [Prop_53]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_53]	 ELSE [Prop_54]	  END AS [Prop_54]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_54]	 ELSE [Prop_55]	  END AS [Prop_55]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_55]	 ELSE [Prop_56]	  END AS [Prop_56]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_56]	 ELSE [Prop_57]	  END AS [Prop_57]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_57]	 ELSE [Prop_58]	  END AS [Prop_58]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_58]	 ELSE [Prop_59]	  END AS [Prop_59]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_59]	 ELSE [Prop_60]	  END AS [Prop_60]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_60]	 ELSE [Prop_61]	  END AS [Prop_61]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_61]	 ELSE [Prop_62]	  END AS [Prop_62]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_62]	 ELSE [Prop_63]	  END AS [Prop_63]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_63]	 ELSE [Prop_64]	  END AS [Prop_64]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_64]	 ELSE [Prop_65]	  END AS [Prop_65]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_65]	 ELSE [Prop_66]	  END AS [Prop_66]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_66]	 ELSE [Prop_67]	  END AS [Prop_67]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_67]	 ELSE [Prop_68]	  END AS [Prop_68]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_68]	 ELSE [Prop_69]	  END AS [Prop_69]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_69]	 ELSE [Prop_70]	  END AS [Prop_70]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_70]	 ELSE [Prop_71]	  END AS [Prop_71]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_71]	 ELSE [Prop_72]	  END AS [Prop_72]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_72]	 ELSE [Prop_73]	  END AS [Prop_73]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_73]	 ELSE [Prop_74]	  END AS [Prop_74]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_74]	 ELSE [Prop_75]	  END AS [Prop_75]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_75]	 ELSE [Prop_76]	  END AS [Prop_76]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_76]	 ELSE [Prop_77]	  END AS [Prop_77]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_77]	 ELSE [Prop_78]	  END AS [Prop_78]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_78]	 ELSE [Prop_79]	  END AS [Prop_79]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_79]	 ELSE [Prop_80]	  END AS [Prop_80]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_80]	 ELSE [Prop_81]	  END AS [Prop_81]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_81]	 ELSE [Prop_82]	  END AS [Prop_82]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_82]	 ELSE [Prop_83]	  END AS [Prop_83]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_83]	 ELSE [Prop_84]	  END AS [Prop_84]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_84]	 ELSE [Prop_85]	  END AS [Prop_85]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_85]	 ELSE [Prop_86]	  END AS [Prop_86]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_86]	 ELSE [Prop_87]	  END AS [Prop_87]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_87]	 ELSE [Prop_88]	  END AS [Prop_88]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_88]	 ELSE [Prop_89]	  END AS [Prop_89]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_89]	 ELSE [Prop_90]	  END AS [Prop_90]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_90]	 ELSE [Prop_91]	  END AS [Prop_91]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_91]	 ELSE [Prop_92]	  END AS [Prop_92]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_92]	 ELSE [Prop_93]	  END AS [Prop_93]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_93]	 ELSE [Prop_94]	  END AS [Prop_94]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_94]	 ELSE [Prop_95]	  END AS [Prop_95]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_95]	 ELSE [Prop_96]	  END AS [Prop_96]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_96]	 ELSE [Prop_97]	  END AS [Prop_97]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_97]	 ELSE [Prop_98]	  END AS [Prop_98]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN [Prop_98]	  ELSE [Prop_99]  END AS  [Prop_99]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_99]  ELSE [Prop_100] END AS  [Prop_100]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_100] ELSE [Prop_101] END AS  [Prop_101]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_101] ELSE [Prop_102] END AS  [Prop_102]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_102] ELSE [Prop_103] END AS  [Prop_103]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_103] ELSE [Prop_104] END AS  [Prop_104]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_104] ELSE [Prop_105] END AS  [Prop_105]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_105] ELSE [Prop_106] END AS  [Prop_106]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_106] ELSE [Prop_107] END AS  [Prop_107]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_107] ELSE [Prop_108] END AS  [Prop_108]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_108] ELSE [Prop_109] END AS  [Prop_109]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_109] ELSE [Prop_110] END AS  [Prop_110]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_110] ELSE [Prop_111] END AS  [Prop_111]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_111] ELSE [Prop_112] END AS  [Prop_112]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_112] ELSE [Prop_113] END AS  [Prop_113]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_113] ELSE [Prop_114] END AS  [Prop_114]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_114] ELSE [Prop_115] END AS  [Prop_115]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_115] ELSE [Prop_116] END AS  [Prop_116]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_116] ELSE [Prop_117] END AS  [Prop_117]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_117] ELSE [Prop_118] END AS  [Prop_118]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_118] ELSE [Prop_119] END AS  [Prop_119]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_119] ELSE [Prop_120] END AS  [Prop_120]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_120] ELSE [Prop_121] END AS  [Prop_121]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_121] ELSE [Prop_122] END AS  [Prop_122]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_122] ELSE [Prop_123] END AS  [Prop_123]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_123] ELSE [Prop_124] END AS  [Prop_124]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_124] ELSE [Prop_125] END AS  [Prop_125]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_125] ELSE [Prop_126] END AS  [Prop_126]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_126] ELSE [Prop_127] END AS  [Prop_127]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_127] ELSE [Prop_128] END AS  [Prop_128]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_128] ELSE [Prop_129] END AS  [Prop_129]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_129] ELSE [Prop_130] END AS  [Prop_130]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_130] ELSE [Prop_131] END AS  [Prop_131]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_131] ELSE [Prop_132] END AS  [Prop_132]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_132] ELSE [Prop_133] END AS  [Prop_133]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_133] ELSE [Prop_134] END AS  [Prop_134]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_134] ELSE [Prop_135] END AS  [Prop_135]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_135] ELSE [Prop_136] END AS  [Prop_136]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_136] ELSE [Prop_137] END AS  [Prop_137]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_137] ELSE [Prop_138] END AS  [Prop_138]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_138] ELSE [Prop_139] END AS  [Prop_139]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_139] ELSE [Prop_140] END AS  [Prop_140]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_140] ELSE [Prop_141] END AS  [Prop_141]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_141] ELSE [Prop_142] END AS  [Prop_142]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_142] ELSE [Prop_143] END AS  [Prop_143]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_143] ELSE [Prop_144] END AS  [Prop_144]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_144] ELSE [Prop_145] END AS  [Prop_145]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_145] ELSE [Prop_146] END AS  [Prop_146]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_146] ELSE [Prop_147] END AS  [Prop_147]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_147] ELSE [Prop_148] END AS  [Prop_148]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_148] ELSE [Prop_149] END AS  [Prop_149]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_149] ELSE [Prop_150] END AS  [Prop_150]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_150] ELSE [Prop_151] END AS  [Prop_151]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_151] ELSE [Prop_152] END AS  [Prop_152]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_152] ELSE [Prop_153] END AS  [Prop_153]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_153] ELSE [Prop_154] END AS  [Prop_154]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_154] ELSE [Prop_155] END AS  [Prop_155]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_155] ELSE [Prop_156] END AS  [Prop_156]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_156] ELSE [Prop_157] END AS  [Prop_157]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_157] ELSE [Prop_158] END AS  [Prop_158]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_158] ELSE [Prop_159] END AS  [Prop_159]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_159] ELSE [Prop_160] END AS  [Prop_160]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_160] ELSE [Prop_161] END AS  [Prop_161]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_161] ELSE [Prop_162] END AS  [Prop_162]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_162] ELSE [Prop_163] END AS  [Prop_163]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_163] ELSE [Prop_164] END AS  [Prop_164]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_164] ELSE [Prop_165] END AS  [Prop_165]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_165] ELSE [Prop_166] END AS  [Prop_166]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_166] ELSE [Prop_167] END AS  [Prop_167]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_167] ELSE [Prop_168] END AS  [Prop_168]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_168] ELSE [Prop_169] END AS  [Prop_169]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_169] ELSE [Prop_170] END AS  [Prop_170]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_170] ELSE [Prop_171] END AS  [Prop_171]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_171] ELSE [Prop_172] END AS  [Prop_172]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_172] ELSE [Prop_173] END AS  [Prop_173]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_173] ELSE [Prop_174] END AS  [Prop_174]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_174] ELSE [Prop_175] END AS  [Prop_175]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_175] ELSE [Prop_176] END AS  [Prop_176]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_176] ELSE [Prop_177] END AS  [Prop_177]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_177] ELSE [Prop_178] END AS  [Prop_178]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_178] ELSE [Prop_179] END AS  [Prop_179]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_179] ELSE [Prop_180] END AS  [Prop_180]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_180] ELSE [Prop_181] END AS  [Prop_181]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_181] ELSE [Prop_182] END AS  [Prop_182]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_182] ELSE [Prop_183] END AS  [Prop_183]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_183] ELSE [Prop_184] END AS  [Prop_184]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_184] ELSE [Prop_185] END AS  [Prop_185]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_185] ELSE [Prop_186] END AS  [Prop_186]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_186] ELSE [Prop_187] END AS  [Prop_187]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_187] ELSE [Prop_188] END AS  [Prop_188]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_188] ELSE [Prop_189] END AS  [Prop_189]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_189] ELSE [Prop_190] END AS  [Prop_190]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_190] ELSE [Prop_191] END AS  [Prop_191]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_191] ELSE [Prop_192] END AS  [Prop_192]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_192] ELSE [Prop_193] END AS  [Prop_193]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_193] ELSE [Prop_194] END AS  [Prop_194]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_194] ELSE [Prop_195] END AS  [Prop_195]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_195] ELSE [Prop_196] END AS  [Prop_196]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_196] ELSE [Prop_197] END AS  [Prop_197]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_197] ELSE [Prop_198] END AS  [Prop_198]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_198] ELSE [Prop_199] END AS  [Prop_199]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_199] ELSE [Prop_200] END AS  [Prop_200]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_200] ELSE [Prop_201] END AS  [Prop_201]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_201] ELSE [Prop_202] END AS  [Prop_202]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_202] ELSE [Prop_203] END AS  [Prop_203]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_203] ELSE [Prop_204] END AS  [Prop_204]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_204] ELSE [Prop_205] END AS  [Prop_205]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_205] ELSE [Prop_206] END AS  [Prop_206]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_206] ELSE [Prop_207] END AS  [Prop_207]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_207] ELSE [Prop_208] END AS  [Prop_208]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_208] ELSE [Prop_209] END AS  [Prop_209]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_209] ELSE [Prop_210] END AS  [Prop_210]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_210] ELSE [Prop_211] END AS  [Prop_211]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_211] ELSE [Prop_212] END AS  [Prop_212]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_212] ELSE [Prop_213] END AS  [Prop_213]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_213] ELSE [Prop_214] END AS  [Prop_214]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_214] ELSE [Prop_215] END AS  [Prop_215]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_215] ELSE [Prop_216] END AS  [Prop_216]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_216] ELSE [Prop_217] END AS  [Prop_217]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_217] ELSE [Prop_218] END AS  [Prop_218]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_218] ELSE [Prop_219] END AS  [Prop_219]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_219] ELSE [Prop_220] END AS  [Prop_220]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_220] ELSE [Prop_221] END AS  [Prop_221]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_221] ELSE [Prop_222] END AS  [Prop_222]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_222] ELSE [Prop_223] END AS  [Prop_223]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_223] ELSE [Prop_224] END AS  [Prop_224]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_224] ELSE [Prop_225] END AS  [Prop_225]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_225] ELSE [Prop_226] END AS  [Prop_226]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_226] ELSE [Prop_227] END AS  [Prop_227]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_227] ELSE [Prop_228] END AS  [Prop_228]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_228] ELSE [Prop_229] END AS  [Prop_229]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_229] ELSE [Prop_230] END AS  [Prop_230]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_230] ELSE [Prop_231] END AS  [Prop_231]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_231] ELSE [Prop_232] END AS  [Prop_232]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_232] ELSE [Prop_233] END AS  [Prop_233]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_233] ELSE [Prop_234] END AS  [Prop_234]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_234] ELSE [Prop_235] END AS  [Prop_235]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_235] ELSE [Prop_236] END AS  [Prop_236]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_236] ELSE [Prop_237] END AS  [Prop_237]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_237] ELSE [Prop_238] END AS  [Prop_238]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_238] ELSE [Prop_239] END AS  [Prop_239]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_239] ELSE [Prop_240] END AS  [Prop_240]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_240] ELSE [Prop_241] END AS  [Prop_241]
		  ,CASE WHEN [Prop_1] = 'MHR' THEN  [Prop_241] ELSE [Prop_242] END AS  [Prop_242]
		  ,[m_ExecutionDt]				    
	FROM stg.tKlsInput ipt
		INNER JOIN DateMapping dm 
			ON CAST(ipt.Prop_0 AS DATE) = dm.SampleDate