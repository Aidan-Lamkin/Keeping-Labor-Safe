
CREATE VIEW [dbo].[vwAllRiskFactors] 
AS

	SELECT * FROM 
		(SELECT INPATIENT_DATA_ID AS CaseID, RiskFactorKey, RiskFactorValue FROM dbo.vwRiskFactors) t
	PIVOT (
		MAX(RiskFactorValue)
		FOR RiskFactorKey IN (
		  [FETAL_RF_ARRYTHMIA]
	, [FETAL_RF_INTRAUTERINE_RESUSCITATION]
	, [FETAL_RF_INTRAUTERINE_RESUSCITATION_DT]
	, [FETAL_RF_IUGR]
	, [FETAL_RF_MECONIUM]
	, [FETAL_RF_MECONIUM_DT]
	, [FETAL_RF_PREMIE]
	, [FETAL_RF_SECOND_STAGE]
	, [FETAL_RF_SECOND_STAGE_DT]
	, [FETAL_RF_TERMINAL_BRADYCARDIA]
	, [FETAL_RF_TERMINAL_BRADYCARDIA_DT]
	, [MATERNAL_RF_AGE]
	, [MATERNAL_RF_AGE_D]
	, [MATERNAL_RF_CARDIAC_DT1]
	, [MATERNAL_RF_CARDIAC1]
	, [MATERNAL_RF_DIABETES]
	, [MATERNAL_RF_DIABETES_DT]
	, [MATERNAL_RF_EPIDURAL]
	, [MATERNAL_RF_EPIDURAL_DT]
	, [MATERNAL_RF_GEST_AGE]
	, [MATERNAL_RF_GEST_AGE_DT]
	, [MATERNAL_RF_GRAVIDA]
	, [MATERNAL_RF_HTN_PRE_E]
	, [MATERNAL_RF_HTN_PRE_E_DT]
	, [MATERNAL_RF_OBESITY]
	, [MATERNAL_RF_OBESITY_DT]
	, [MATERNAL_RF_PARITY]
	, [MATERNAL_RF_PULMONARY_DT1]
	, [MATERNAL_RF_PULMONARY1]
	, [MATERNAL_RF_SHORT_STATURE]
	, [OBSTETRICAL_RF_AROM]
	, [OBSTETRICAL_RF_AROM_DT]
	, [OBSTETRICAL_RF_ARREST]
	, [OBSTETRICAL_RF_ARREST_DT]
	, [OBSTETRICAL_RF_BLEEDING]
	, [OBSTETRICAL_RF_MACROSOMIA_LGA]
	, [OBSTETRICAL_RF_MACROSOMIA_LGA_DT]
	, [OBSTETRICAL_RF_MAL_PRESENTATION]
	, [OBSTETRICAL_RF_OLI_GOHYDRAMNIOS]
	, [OBSTETRICAL_RF_OLI_GOHYDRAMNIOS_DT]
	, [OBSTETRICAL_RF_POLY_HYDRAMNIOS]
	, [OBSTETRICAL_RF_POLY_HYDRAMNIOS_DT]
	, [OBSTETRICAL_RF_PREV_C_SECTION]
	, [OBSTETRICAL_RF_PREV_C_SECTION_DT]
	, [OBSTETRICAL_RF_PROM]
	, [OBSTETRICAL_RF_PROM_DT]
	, [OBSTETRICAL_RF_PROTRACTION]
	, [OBSTETRICAL_RF_PROTRACTION_DT]
	, [OBSTETRICAL_RF_SROM]
	, [OBSTETRICAL_RF_SROM_DT] )
	) pvt